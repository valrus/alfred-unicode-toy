# -*- coding: utf-8 -*-

from __future__ import unicode_literals
from __future__ import print_function

import argparse
import codecs
import itertools
import json
import os
import string
import sys

TRANSLATION_BASE = string.printable.strip()

TRANSLATIONS = {
    "Circled": '''0â‘ â‘¡â‘¢â‘£â‘¤â‘¥â‘¦â‘§â‘¨â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“â“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©â’¶â’·â’¸â’¹â’ºâ’»â’¼â’½â’¾â’¿â“€â“â“‚â“ƒâ“„â“…â“†â“‡â“ˆâ“‰â“Šâ“‹â“Œâ“â“â“!"#$%&â¦¸'()âŠ›âŠ•,âŠ–â¨€âŠ˜:;â§€âŠœâ§?@[â¦¸â¦¸]^_`{â¦¶}~''',
    "Circled (neg)": '''â“¿123456789ğŸ…ğŸ…‘ğŸ…’ğŸ…“ğŸ…”ğŸ…•ğŸ…–ğŸ…—ğŸ…˜ğŸ…™ğŸ…šğŸ…›ğŸ…œğŸ…ğŸ…ğŸ…ŸğŸ… ğŸ…¡ğŸ…¢ğŸ…£ğŸ…¤ğŸ…¥ğŸ…¦ğŸ…§ğŸ…¨ğŸ…©ğŸ…ğŸ…‘ğŸ…’ğŸ…“ğŸ…”ğŸ…•ğŸ…–ğŸ…—ğŸ…˜ğŸ…™ğŸ…šğŸ…›ğŸ…œğŸ…ğŸ…ğŸ…ŸğŸ… ğŸ…¡ğŸ…¢ğŸ…£ğŸ…¤ğŸ…¥ğŸ…¦ğŸ…§ğŸ…¨ğŸ…©!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Fullwidth": '''ï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™ï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½ï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½šï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼ºï¼"ï¼ƒï¼„ï¼…ï¼†ï¼¼ï¼‡ï¼ˆï¼‰ï¼Šï¼‹ï¼Œï¼ï¼ï¼ï¼šï¼›<ï¼>ï¼Ÿï¼ ï¼»ï¼¼ï¼¼ï¼½ï¼¾ï¼¿ï½€ï½›ï½œï½ï½''',
    "Math bold": '''ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ğ°ğ±ğ²ğ³ğ€ğğ‚ğƒğ„ğ…ğ†ğ‡ğˆğ‰ğŠğ‹ğŒğğğğğ‘ğ’ğ“ğ”ğ•ğ–ğ—ğ˜ğ™!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math bold Fraktur": '''0123456789ğ–†ğ–‡ğ–ˆğ–‰ğ–Šğ–‹ğ–Œğ–ğ–ğ–ğ–ğ–‘ğ–’ğ–“ğ–”ğ–•ğ––ğ–—ğ–˜ğ–™ğ–šğ–›ğ–œğ–ğ–ğ–Ÿğ•¬ğ•­ğ•®ğ•¯ğ•°ğ•±ğ•²ğ•³ğ•´ğ•µğ•¶ğ•·ğ•¸ğ•¹ğ•ºğ•»ğ•¼ğ•½ğ•¾ğ•¿ğ–€ğ–ğ–‚ğ–ƒğ–„ğ–…!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math bold italic": '''0123456789ğ’‚ğ’ƒğ’„ğ’…ğ’†ğ’‡ğ’ˆğ’‰ğ’Šğ’‹ğ’Œğ’ğ’ğ’ğ’ğ’‘ğ’’ğ’“ğ’”ğ’•ğ’–ğ’—ğ’˜ğ’™ğ’šğ’›ğ‘¨ğ‘©ğ‘ªğ‘«ğ‘¬ğ‘­ğ‘®ğ‘¯ğ‘°ğ‘±ğ‘²ğ‘³ğ‘´ğ‘µğ‘¶ğ‘·ğ‘¸ğ‘¹ğ‘ºğ‘»ğ‘¼ğ‘½ğ‘¾ğ‘¿ğ’€ğ’!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math bold script": '''0123456789ğ“ªğ“«ğ“¬ğ“­ğ“®ğ“¯ğ“°ğ“±ğ“²ğ“³ğ“´ğ“µğ“¶ğ“·ğ“¸ğ“¹ğ“ºğ“»ğ“¼ğ“½ğ“¾ğ“¿ğ”€ğ”ğ”‚ğ”ƒğ“ğ“‘ğ“’ğ““ğ“”ğ“•ğ“–ğ“—ğ“˜ğ“™ğ“šğ“›ğ“œğ“ğ“ğ“Ÿğ“ ğ“¡ğ“¢ğ“£ğ“¤ğ“¥ğ“¦ğ“§ğ“¨ğ“©!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math double-struck": '''ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡ğ•’ğ•“ğ•”ğ••ğ•–ğ•—ğ•˜ğ•™ğ•šğ•›ğ•œğ•ğ•ğ•Ÿğ• ğ•¡ğ•¢ğ•£ğ•¤ğ•¥ğ•¦ğ•§ğ•¨ğ•©ğ•ªğ•«ğ”¸ğ”¹â„‚ğ”»ğ”¼ğ”½ğ”¾â„ğ•€ğ•ğ•‚ğ•ƒğ•„â„•ğ•†â„™â„šâ„ğ•Šğ•‹ğ•Œğ•ğ•ğ•ğ•â„¤!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math monospace": '''ğŸ¶ğŸ·ğŸ¸ğŸ¹ğŸºğŸ»ğŸ¼ğŸ½ğŸ¾ğŸ¿ğšŠğš‹ğšŒğšğšğšğšğš‘ğš’ğš“ğš”ğš•ğš–ğš—ğš˜ğš™ğššğš›ğšœğšğšğšŸğš ğš¡ğš¢ğš£ğ™°ğ™±ğ™²ğ™³ğ™´ğ™µğ™¶ğ™·ğ™¸ğ™¹ğ™ºğ™»ğ™¼ğ™½ğ™¾ğ™¿ğš€ğšğš‚ğšƒğš„ğš…ğš†ğš‡ğšˆğš‰!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math sans": '''ğŸ¢ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ§ğŸ¨ğŸ©ğŸªğŸ«ğ–ºğ–»ğ–¼ğ–½ğ–¾ğ–¿ğ—€ğ—ğ—‚ğ—ƒğ—„ğ—…ğ—†ğ—‡ğ—ˆğ—‰ğ—Šğ—‹ğ—Œğ—ğ—ğ—ğ—ğ—‘ğ—’ğ—“ğ– ğ–¡ğ–¢ğ–£ğ–¤ğ–¥ğ–¦ğ–§ğ–¨ğ–©ğ–ªğ–«ğ–¬ğ–­ğ–®ğ–¯ğ–°ğ–±ğ–²ğ–³ğ–´ğ–µğ–¶ğ–·ğ–¸ğ–¹!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math sans bold": '''ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸ°ğŸ±ğŸ²ğŸ³ğŸ´ğŸµğ—®ğ—¯ğ—°ğ—±ğ—²ğ—³ğ—´ğ—µğ—¶ğ—·ğ—¸ğ—¹ğ—ºğ—»ğ—¼ğ—½ğ—¾ğ—¿ğ˜€ğ˜ğ˜‚ğ˜ƒğ˜„ğ˜…ğ˜†ğ˜‡ğ—”ğ—•ğ—–ğ——ğ—˜ğ—™ğ—šğ—›ğ—œğ—ğ—ğ—Ÿğ— ğ—¡ğ—¢ğ—£ğ—¤ğ—¥ğ—¦ğ—§ğ—¨ğ—©ğ—ªğ—«ğ—¬ğ—­!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math sans bold italic": '''0123456789ğ™–ğ™—ğ™˜ğ™™ğ™šğ™›ğ™œğ™ğ™ğ™Ÿğ™ ğ™¡ğ™¢ğ™£ğ™¤ğ™¥ğ™¦ğ™§ğ™¨ğ™©ğ™ªğ™«ğ™¬ğ™­ğ™®ğ™¯ğ˜¼ğ˜½ğ˜¾ğ˜¿ğ™€ğ™ğ™‚ğ™ƒğ™„ğ™…ğ™†ğ™‡ğ™ˆğ™‰ğ™Šğ™‹ğ™Œğ™ğ™ğ™ğ™ğ™‘ğ™’ğ™“ğ™”ğ™•!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math sans italic": '''0123456789ğ˜¢ğ˜£ğ˜¤ğ˜¥ğ˜¦ğ˜§ğ˜¨ğ˜©ğ˜ªğ˜«ğ˜¬ğ˜­ğ˜®ğ˜¯ğ˜°ğ˜±ğ˜²ğ˜³ğ˜´ğ˜µğ˜¶ğ˜·ğ˜¸ğ˜¹ğ˜ºğ˜»ğ˜ˆğ˜‰ğ˜Šğ˜‹ğ˜Œğ˜ğ˜ğ˜ğ˜ğ˜‘ğ˜’ğ˜“ğ˜”ğ˜•ğ˜–ğ˜—ğ˜˜ğ˜™ğ˜šğ˜›ğ˜œğ˜ğ˜ğ˜Ÿğ˜ ğ˜¡!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Parenthesized": '''0â‘´â‘µâ‘¶â‘·â‘¸â‘¹â‘ºâ‘»â‘¼â’œâ’â’â’Ÿâ’ â’¡â’¢â’£â’¤â’¥â’¦â’§â’¨â’©â’ªâ’«â’¬â’­â’®â’¯â’°â’±â’²â’³â’´â’µâ’œâ’â’â’Ÿâ’ â’¡â’¢â’£â’¤â’¥â’¦â’§â’¨â’©â’ªâ’«â’¬â’­â’®â’¯â’°â’±â’²â’³â’´â’µ!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Regional Indicator": '''0123456789ğŸ‡¦ğŸ‡§ğŸ‡¨ğŸ‡©ğŸ‡ªğŸ‡«ğŸ‡¬ğŸ‡­ğŸ‡®ğŸ‡¯ğŸ‡°ğŸ‡±ğŸ‡²ğŸ‡³ğŸ‡´ğŸ‡µğŸ‡¶ğŸ‡·ğŸ‡¸ğŸ‡¹ğŸ‡ºğŸ‡»ğŸ‡¼ğŸ‡½ğŸ‡¾ğŸ‡¿ğŸ‡¦ğŸ‡§ğŸ‡¨ğŸ‡©ğŸ‡ªğŸ‡«ğŸ‡¬ğŸ‡­ğŸ‡®ğŸ‡¯ğŸ‡°ğŸ‡±ğŸ‡²ğŸ‡³ğŸ‡´ğŸ‡µğŸ‡¶ğŸ‡·ğŸ‡¸ğŸ‡¹ğŸ‡ºğŸ‡»ğŸ‡¼ğŸ‡½ğŸ‡¾ğŸ‡¿!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Squared": '''0123456789ğŸ„°ğŸ„±ğŸ„²ğŸ„³ğŸ„´ğŸ„µğŸ„¶ğŸ„·ğŸ„¸ğŸ„¹ğŸ„ºğŸ„»ğŸ„¼ğŸ„½ğŸ„¾ğŸ„¿ğŸ…€ğŸ…ğŸ…‚ğŸ…ƒğŸ…„ğŸ……ğŸ…†ğŸ…‡ğŸ…ˆğŸ…‰ğŸ„°ğŸ„±ğŸ„²ğŸ„³ğŸ„´ğŸ„µğŸ„¶ğŸ„·ğŸ„¸ğŸ„¹ğŸ„ºğŸ„»ğŸ„¼ğŸ„½ğŸ„¾ğŸ„¿ğŸ…€ğŸ…ğŸ…‚ğŸ…ƒğŸ…„ğŸ……ğŸ…†ğŸ…‡ğŸ…ˆğŸ…‰!"#$%&â§…'()â§†âŠ,âŠŸâŠ¡â§„:;<=>?@[â§…â§…]^_`{|}~''',
    "Squared (neg)": '''0123456789ğŸ…°ğŸ…±ğŸ…²ğŸ…³ğŸ…´ğŸ…µğŸ…¶ğŸ…·ğŸ…¸ğŸ…¹ğŸ…ºğŸ…»ğŸ…¼ğŸ…½ğŸ…¾ğŸ…¿ğŸ†€ğŸ†ğŸ†‚ğŸ†ƒğŸ†„ğŸ†…ğŸ††ğŸ†‡ğŸ†ˆğŸ†‰ğŸ…°ğŸ…±ğŸ…²ğŸ…³ğŸ…´ğŸ…µğŸ…¶ğŸ…·ğŸ…¸ğŸ…¹ğŸ…ºğŸ…»ğŸ…¼ğŸ…½ğŸ…¾ğŸ…¿ğŸ†€ğŸ†ğŸ†‚ğŸ†ƒğŸ†„ğŸ†…ğŸ††ğŸ†‡ğŸ†ˆğŸ†‰!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "A-cute": '''0123456789Ã¡bÄ‡dÃ©fÇµhÃ­já¸±Äºá¸¿Å„Å‘á¹•qÅ•Å›tÃºváºƒxÓ³ÅºÃBÄ†DÃ‰FÇ´HÃ­Já¸°Ä¹á¸¾ÅƒÅá¹”QÅ”Å›TÅ°Váº‚XÓ²Å¹!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "CJK+Thai": '''0123456789ï¾‘ä¹ƒcdä¹‡ï½·gã‚“ï¾‰ï¾Œã‚ºï¾šï¾¶åˆ€oï½±qå°ºä¸‚ï½²uâˆšwï¾’ï¾˜ä¹™ï¾‘ä¹ƒcdä¹‡ï½·gã‚“ï¾‰ï¾Œã‚ºï¾šï¾¶åˆ€oï½±qå°ºä¸‚ï½²uâˆšwï¾’ï¾˜ä¹™!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Curvy 1": '''0123456789à¸„à¹’ÆˆÉ—ï»‰à¤¿ï»­É¦Ù±ï»á›•É­à¹“à¸Ñ»ÏÛ¹É¼à¸£Õ‡àªªÛ·à¸à¸‹×¥Õ¹à¸„à¹’ÆˆÉ—ï»‰à¤¿ï»­É¦Ù±ï»á›•É­à¹“à¸Ñ»ÏÛ¹É¼à¸£Õ‡àªªÛ·à¸à¸‹×¥Õ¹!"#$%&\'()*+,-Ü/:;<=>?@[\\]^_`{|}~''',
    "Curvy 2": '''0123456789Î±Ğ²Â¢âˆ‚Ñ”Æ’ï»­Ğ½Î¹× Ğºâ„“Ğ¼Î·ÏƒÏÛ¹ÑÑ•Ñ‚Ï…Î½Ï‰Ï‡ÑƒÕ¹Î±Ğ²Â¢âˆ‚Ñ”Æ’ï»­Ğ½Î¹× Ğºâ„“Ğ¼Î·ÏƒÏÛ¹ÑÑ•Ñ‚Ï…Î½Ï‰Ï‡ÑƒÕ¹!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Curvy 3": '''0123456789à¸„à¹’Ï‚à¹”Ñ”Å¦ï»®Ñ’à¹€×ŸĞºÉ­à¹“à¸ à¹×§á»£Ğ³à¸£Õ‡à¸¢×©à¸¬××¥Õ¹à¸„à¹’Ï‚à¹”Ñ”Å¦ï»®Ñ’à¹€×ŸĞºÉ­à¹“à¸ à¹×§á»£Ğ³à¸£Õ‡à¸¢×©à¸¬××¥Õ¹!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Faux Cyrillic": '''0123456789Ğ°ÑŠÑâ†ÑfĞ‘Ğ‚Ñ–Ñ˜ĞºlĞ¼Ğ¸Ğ¾Ñ€qÑ“Ñ•Ñ‚Ñ†vÑˆÑ…ĞzĞ”Ğ‘Ò€â†Ğ„FĞ‘ĞĞ†ĞˆĞŒLĞœĞ˜Ğ¤Ğ QĞ¯Ğ…Ğ“Ğ¦VĞ©Ğ–Ğ§Z!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Faux Ethiopic": '''0123456789áˆáŒŒáˆ­á‹•á‰¿á‰»áŠ—á‹˜áŒáŒ‹áŒ•áˆ¨áŒ áŠ­á‹á‹¨á‹’á‹ªáŠá•áˆáˆ€áˆ áˆ¸áˆƒáŒŠáˆáŒŒáˆ­á‹•á‰¿á‰»áŠ—á‹˜áŒáŒ‹áŒ•áˆ¨áŒ áŠ­á‹á‹¨á‹’á‹ªáŠá•áˆáˆ€áˆ áˆ¸áˆƒáŒŠ!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Math Fraktur": '''0123456789ğ”ğ”Ÿğ” ğ”¡ğ”¢ğ”£ğ”¤ğ”¥ğ”¦ğ”§ğ”¨ğ”©ğ”ªğ”«ğ”¬ğ”­ğ”®ğ”¯ğ”°ğ”±ğ”²ğ”³ğ”´ğ”µğ”¶ğ”·ğ”„ğ”…â„­ğ”‡ğ”ˆğ”‰ğ”Šâ„Œâ„‘ğ”ğ”ğ”ğ”ğ”‘ğ”’ğ”“ğ””â„œğ”–ğ”—ğ”˜ğ”™ğ”šğ”›ğ”œâ„¨!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Rock Dots": '''012ÓŸ456789Ã¤á¸…Ä‹á¸‹Ã«á¸ŸÄ¡á¸§Ã¯já¸³á¸·á¹á¹…Ã¶á¹—qá¹›á¹¡áº—Ã¼á¹¿áº…áºÃ¿Å¼Ã„á¸„ÄŠá¸ŠĞá¸Ä á¸¦Ğ‡Já¸²á¸¶á¹€á¹„Ã–á¹–Qá¹šá¹ á¹ªÃœá¹¾áº„áºŒÅ¸Å»!"#$%&\'()*+,â¸šâˆµ/:;<=>?@[\\]^_`{|}~''',
    "Small Caps": '''0123456789á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´©qÊ€êœ±á´›á´œá´ á´¡xyá´¢á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´©QÊ€êœ±á´›á´œá´ á´¡xYá´¢!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Stroked": '''01Æ»3456789ÈºÆ€È¼Ä‘É‡fÇ¥Ä§É¨É‰êÅ‚mnÃ¸áµ½ê—ÉsÅ§áµ¾vwxÉÆ¶ÈºÉƒÈ»ÄÉ†FÇ¤Ä¦Æ—Éˆê€ÅMNÃ˜â±£ê–ÉŒSÅ¦áµ¾VWXÉÆµ!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Subscript": '''â‚€â‚â‚‚â‚ƒâ‚„â‚…â‚†â‚‡â‚ˆâ‚‰â‚bcdâ‚‘fgâ‚•áµ¢â±¼â‚–â‚—â‚˜â‚™â‚’â‚šqáµ£â‚›â‚œáµ¤áµ¥wâ‚“yzâ‚BCDâ‚‘FGâ‚•áµ¢â±¼â‚–â‚—â‚˜â‚™â‚’â‚šQáµ£â‚›â‚œáµ¤áµ¥Wâ‚“YZ!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Superscript": '''â°Â¹Â²Â³â´âµâ¶â·â¸â¹áµƒáµ‡á¶œáµˆáµ‰á¶ áµÊ°â±Ê²áµË¡áµâ¿áµ’áµ–qÊ³Ë¢áµ—áµ˜áµ›Ê·Ë£Ê¸á¶»á´¬á´®á¶œá´°á´±á¶ á´³á´´á´µá´¶á´·á´¸á´¹á´ºá´¼á´¾Qá´¿Ë¢áµ€áµâ±½áµ‚Ë£Ê¸á¶»!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~''',
    "Inverted": '''0123456789ÉqÉ”pÇÉŸÆƒÉ¥Ä±É¾Ê×ŸÉ¯uodbÉ¹sÊ‡nÊŒÊxÊzÉqÉ”pÇÉŸÆƒÉ¥Ä±É¾Ê×ŸÉ¯uodbÉ¹sÊ‡nğŒ¡ÊxÊzÂ¡"#$%â…‹\,()*+â€˜-./:;<=>Â¿@[\\]^_`{|}~''',
    "Reversed": '''0ß23456789Adâ†„bÉ˜êŸ»gHijklmá´oqpá´™ê™…TUvwxYzAdâ†ƒbÆêŸ»GHIJKâ…ƒMá´OêŸ¼pá´™ê™„TUVWXYZ!"#$%&\'()*+,-./:â<=>â¸®@[\\]^_`{|}âˆ½'''
}


def grouper(iterable, n, fillvalue=None):
    """Collect data into fixed-length chunks or blocks.

    From https://docs.python.org/2/library/itertools.html#recipes
    """
    # grouper('ABCDEFG', 3, 'x') --> ABC DEF Gxx
    args = [iter(iterable)] * n
    return itertools.izip_longest(fillvalue=fillvalue, *args)


def getUTF16Chars(s):
    """Get a list of UTF-16 representations of the chars in a word.

    In particular, surrogate pairs will be kept together for chars outside the BMP.

    Logic: encode the string to UTF-32, split it to 4-byte chunks, then decode each chunk.
    Because each 4-byte chunk represents a single character in utf32, decoding non-BMP chars will
    produce utf-16 surrogate pairs on narrow Python builds and single unicode chars on wide builds.
    """
    return [b''.join(u32_bytes).decode('utf-32be') for u32_bytes in grouper(s.encode('utf-32be'), 4)]


def ordUTF32(u32c):
    return int(u32c.encode('hex'), 16)


def make_item(title, text):
    encoded_text = text.encode('utf-8')
    return dict(
        title=title,
        subtitle=encoded_text,
        valid=True,
        arg=json.dumps({
            'alfredworkflow': {
                'arg': encoded_text,
            }
        }),
        icon='icon.png',
        autocomplete=title,
        text={
            'copy': encoded_text,
            'largetype': encoded_text
        }
    )


def toy_translate(text, result_string):
    # A normal translate dict doesn't work because of the narrow Python build;
    # characters outside the BMP are expressed as surrogate pairs so aren't suitable.
    toy_map = dict(zip(TRANSLATION_BASE, getUTF16Chars(result_string)))
    return ''.join([ toy_map.get(c, c) for c in text ])


def main():
    parser = argparse.ArgumentParser()
    parser.add_argument('query')
    args = parser.parse_args()

    query = args.query.decode('utf-8')

    print(json.dumps({
        'items': [
            make_item(translation_name, toy_translate(query, translation_string))
            for translation_name, translation_string in TRANSLATIONS.iteritems()
        ]
    }))


if __name__ == '__main__':
    main()
